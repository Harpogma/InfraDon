CREATE TEMP TABLE temp_gender (
    id integer,
    assurance TEXT,
    sexe TEXT,
    adresse_corrigee TEXT
);

COPY temp_gender (id, assurance, sexe, adresse_corrigee) 
FROM 'C:\Users\marc.bridy\InfraDon\InfraDon\data\csv\patient_update.csv' 
WITH CSV HEADER;


INSERT INTO gender (short_descr, long_descr)
SELECT DISTINCT 
       CASE 
           WHEN TRIM(sexe) IN ('Homme') THEN 'Hom'
           WHEN TRIM(sexe) IN ('Femme') THEN 'Fem'
           WHEN TRIM(sexe) IN ('Non-binaire') THEN 'NB'
           ELSE 'N/A'
       END AS short_descr,
       CASE 
           WHEN TRIM(sexe) IN ('Homme') THEN 'Homme'
           WHEN TRIM(sexe) IN ('Femme') THEN 'Femme'
           WHEN TRIM(sexe) IN ('Non-binaire') THEN 'Non-binaire'
           ELSE 'N/A'
       END AS long_descr
FROM temp_gender
WHERE sexe IS NOT NULL AND sexe <> '';